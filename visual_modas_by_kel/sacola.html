<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="design/icone_visualmodasbykel.png">
    <link href="estilos.css" rel="stylesheet">
    <link
        href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <title>Minha Sacola - Visual Modas By Kel</title>
</head>

<body>
    <!-- Cabeçalho -->
    <header class="header">
        <div class="header-content">
            <a href="home.html" class="logo" aria-label="Visual Modas By Kel">VISUAL MODAS BY KEL</a>
            <a href="home.html" aria-label="Logo Visual Modas By Kel">
                <img src="design/logo_visualmodasbykel.png" alt="Logo Visual Modas By Kel" />
            </a>
            <div class="header-icons">
                <form role="search" aria-label="Busca de produtos" onsubmit="return false;">
                    <input type="text" placeholder="O que você procura?" aria-label="Buscar produto" id="searchInput">
                </form>
                <a href="login.html" title="Minha Conta">
                    <img src="design/icone_usuario.png" alt="Minha Conta">
                    <span>Minha conta<br><b>Meus pedidos</b></span>
                </a>
                <a href="favoritos.html" title="Favoritos" id="abrir_favoritos">
                    <img src="design/icone_favoritos.png" alt="Favoritos">
                    <span id="favoritosCount" style="display:none;">0</span>
                </a>
                <a href="sacola.html" title="Sacola" id="abrir_sacola">
                    <img src="design/icone_sacola.png" alt="Sacola">
                    <span id="sacolaCount" style="display:none;">0</span>
                </a>
                <button class="menu-toggle" id="menuToggle" aria-label="Abrir/fechar menu" type="button">
                    <span></span><span></span><span></span>
                </button>
            </div>
        </div>
        <nav class="header-filters" id="headerFilters" aria-label="Navegação principal">
            <ul>
                <li><a href="home.html">CATEGORIAS</a></li>
                <li><a href="home.html">NOVIDADES</a></li>
                <li><a href="home.html">COLEÇÃO</a></li>
                <li><a href="home.html">TENDÊNCIAS</a></li>
                <li><a href="home.html">LOOKBOOK</a></li>
                <li><a href="home.html">PROMOÇÕES</a></li>
                <li><a href="home.html">INSPIRAÇÃO</a></li>
                <li><a href="home.html">OUTLET</a></li>
                <li><a href="home.html">EXCLUSIVOS</a></li>
            </ul>
        </nav>
    </header>

    <!-- Conteúdo Principal -->
    <main class="sacola-page">
        <div class="sacola-container">
            <div class="sacola-header">
                <h1 class="sacola-title">Minha Sacola</h1>
                <p class="sacola-subtitle" id="sacolaTotal">0 itens</p>
            </div>

            <div class="sacola-content">
                <!-- Lista de Itens -->
                <div class="sacola-items-wrapper">
                    <!-- Estado Vazio -->
                    <div class="sacola-empty" id="sacolaEmpty">
                        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="1.5">
                            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                            <line x1="3" y1="6" x2="21" y2="6"/>
                        </svg>
                        <h2>Sua sacola está vazia</h2>
                        <p>Adicione produtos incríveis e comece a montar seu look!</p>
                        <a href="home.html" class="btn-continuar-comprando">Continuar Comprando</a>
                    </div>

                    <!-- Lista de Produtos -->
                    <div class="sacola-items" id="sacolaItems">
                        <!-- Itens serão carregados via JavaScript -->
                    </div>
                </div>

                <!-- Resumo do Pedido -->
                <div class="sacola-resumo" id="sacolaResumo" style="display: none;">
                    <h2 class="resumo-title">Resumo do Pedido</h2>

                    <div class="resumo-linha">
                        <span>Subtotal</span>
                        <span id="resumoSubtotal">R$ 0,00</span>
                    </div>

                    <div class="resumo-linha">
                        <span>Frete</span>
                        <span id="resumoFrete">A calcular</span>
                    </div>

                    <div class="resumo-linha desconto-linha" id="descontoLinha" style="display: none;">
                        <span>Desconto</span>
                        <span id="resumoDesconto">- R$ 0,00</span>
                    </div>

                    <div class="resumo-linha total">
                        <span>Total</span>
                        <span id="resumoTotal">R$ 0,00</span>
                    </div>

                    <button class="btn-finalizar" onclick="finalizarCompra()">Finalizar Compra</button>

                    <!-- <div class="cupom-section">
                        <label>Tem um cupom de desconto?</label>
                        <div class="cupom-input-wrapper">
                            <input type="text" id="cupomInput" placeholder="Digite o cupom" maxlength="20">
                            <button class="btn-aplicar-cupom" onclick="aplicarCupom()">Aplicar</button>
                        </div>
                        <div class="cupom-feedback" id="cupomFeedback"></div>
                    </div> -->
                </div>
            </div>
        </div>
    </main>

    <!-- Rodapé -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>Institucional</h3>
                    <ul>
                        <li><a href="#">Sobre Nós</a></li>
                        <li><a href="#">Nossa História</a></li>
                        <li><a href="#">Trabalhe Conosco</a></li>
                        <li><a href="#">Lojas Físicas</a></li>
                        <li><a href="#">Política de Privacidade</a></li>
                        <li><a href="#">Termos de Uso</a></li>
                    </ul>
                </div>

                <div class="footer-section">
                    <h3>Contato</h3>
                    <p><strong>Telefone:</strong> (48) 9 9957-5303</p>
                    <p><strong>E-mail:</strong> contato@visualmodasbykel.com.br</p>
                    <p><strong>Horário de Atendimento:</strong><br>
                        Segunda a Sexta: 08h30 às 18h<br>
                        Sábado: 08h30 às 17h</p>
                    <div class="footer-social">
                        <a href="#" title="Instagram" aria-label="Instagram">
                            <img src="design/icone_instagram.png" alt="Instagram">
                        </a>
                        <a href="#" title="Facebook" aria-label="Facebook">
                            <img src="design/icone_facebook.png" alt="Facebook">
                        </a>
                        <a href="#" title="TikTok" aria-label="TikTok">
                            <img src="design/icone_tiktok.png" alt="TikTok">
                        </a>
                    </div>
                </div>

                <div class="footer-section">
                    <h3>Formas de Pagamento</h3>
                    <div class="footer-payment">
                        <img src="design/icone_pix.png" alt="Pix" title="Pix">
                    </div>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 Visual Modas By Kel - Todos os direitos reservados</p>
                <p>CNPJ: 00.000.000/0001-00 | Criciúma - SC</p>
                <p>Desenvolvido por <a href="#">Visual Modas By Kel</a></p>
            </div>
        </div>
    </footer>

    <script>
        // Carrega dados do localStorage
        let favorites = JSON.parse(localStorage.getItem('favorites')) || [];
        let cart = JSON.parse(localStorage.getItem('cart')) || [];
        let cupomAplicado = null;
        let descontoAtual = 0;

        // Cupons válidos
        const cupomsValidos = {
            'BEMVINDOVM': { tipo: 'percentual', valor: 10, descricao: '10% de desconto' },
            'PIX5': { tipo: 'percentual', valor: 5, descricao: '5% de desconto no PIX' },
            'FRETEGRATIS': { tipo: 'frete', valor: 0, descricao: 'Frete grátis' }
        };

        function loadCart() {
            const itemsWrapper = document.getElementById('sacolaItems');
            const emptyState = document.getElementById('sacolaEmpty');
            const resumo = document.getElementById('sacolaResumo');
            const totalElement = document.getElementById('sacolaTotal');

            if (cart.length === 0) {
                emptyState.style.display = 'flex';
                itemsWrapper.style.display = 'none';
                resumo.style.display = 'none';
                totalElement.textContent = '0 itens';
            } else {
                emptyState.style.display = 'none';
                itemsWrapper.style.display = 'block';
                resumo.style.display = 'block';
                
                const totalItens = cart.reduce((sum, item) => sum + item.quantity, 0);
                totalElement.textContent = `${totalItens} ${totalItens === 1 ? 'item' : 'itens'}`;

                itemsWrapper.innerHTML = cart.map(item => createCartItem(item)).join('');
                updateResumo();
            }

            updateFavoritesCount();
            updateCartCount();
        }

        function createCartItem(item) {
            return `
                <div class="sacola-item">
                    <div class="item-image">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                    <div class="item-details">
                        <h3 class="item-name">${item.name}</h3>
                        <p class="item-size">Tamanho: <strong>${item.size}</strong></p>
                        <p class="item-price">R$ ${item.price.toFixed(2).replace('.', ',')}</p>
                        
                        <div class="item-actions">
                            <div class="quantity-control">
                                <button class="btn-qty" onclick="updateQuantity(${item.id}, '${item.size}', -1)">−</button>
                                <span class="qty-value">${item.quantity}</span>
                                <button class="btn-qty" onclick="updateQuantity(${item.id}, '${item.size}', 1)">+</button>
                            </div>
                            <button class="btn-remove" onclick="removeFromCart(${item.id}, '${item.size}')">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="3 6 5 6 21 6"></polyline>
                                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                </svg>
                                Remover
                            </button>
                        </div>
                    </div>
                    <div class="item-total">
                        <span class="item-total-label">Total</span>
                        <span class="item-total-value">R$ ${(item.price * item.quantity).toFixed(2).replace('.', ',')}</span>
                    </div>
                </div>
            `;
        }

        function updateQuantity(productId, size, change) {
            const item = cart.find(i => i.id === productId && i.size === size);
            if (!item) return;

            item.quantity += change;

            if (item.quantity <= 0) {
                removeFromCart(productId, size);
                return;
            }

            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart();
        }

        function removeFromCart(productId, size) {
            cart = cart.filter(item => !(item.id === productId && item.size === size));
            localStorage.setItem('cart', JSON.stringify(cart));
            loadCart();
            showNotification('Produto removido da sacola');
        }

        function updateResumo() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            let desconto = 0;

            if (cupomAplicado) {
                const cupom = cupomsValidos[cupomAplicado];
                if (cupom.tipo === 'percentual') {
                    desconto = subtotal * (cupom.valor / 100);
                }
            }

            descontoAtual = desconto;
            const total = subtotal - desconto;

            document.getElementById('resumoSubtotal').textContent = `R$ ${subtotal.toFixed(2).replace('.', ',')}`;
            document.getElementById('resumoTotal').textContent = `R$ ${total.toFixed(2).replace('.', ',')}`;

            if (desconto > 0) {
                document.getElementById('descontoLinha').style.display = 'flex';
                document.getElementById('resumoDesconto').textContent = `- R$ ${desconto.toFixed(2).replace('.', ',')}`;
            } else {
                document.getElementById('descontoLinha').style.display = 'none';
            }

            // Frete grátis acima de R$ 500
            const freteElement = document.getElementById('resumoFrete');
            if (subtotal >= 500) {
                freteElement.textContent = 'GRÁTIS';
                freteElement.style.color = '#28a745';
                freteElement.style.fontWeight = '700';
            } else {
                freteElement.textContent = 'A calcular';
                freteElement.style.color = '';
                freteElement.style.fontWeight = '';
            }
        }

        function aplicarCupom() {
            const input = document.getElementById('cupomInput');
            const cupom = input.value.trim().toUpperCase();
            const feedback = document.getElementById('cupomFeedback');

            if (!cupom) {
                feedback.textContent = 'Digite um cupom válido';
                feedback.className = 'cupom-feedback error';
                feedback.style.display = 'block';
                return;
            }

            if (cupomsValidos[cupom]) {
                cupomAplicado = cupom;
                const cupomData = cupomsValidos[cupom];
                feedback.textContent = `Cupom aplicado! ${cupomData.descricao}`;
                feedback.className = 'cupom-feedback success';
                feedback.style.display = 'block';
                input.value = '';
                updateResumo();
                showNotification('Cupom aplicado com sucesso!');
            } else {
                feedback.textContent = 'Cupom inválido ou expirado';
                feedback.className = 'cupom-feedback error';
                feedback.style.display = 'block';
            }
        }

        function finalizarCompra() {
            if (cart.length === 0) {
                showNotification('Adicione produtos à sacola primeiro!');
                return;
            }

            // Aqui você pode redirecionar para página de checkout
            showNotification('Redirecionando para o checkout...');
            setTimeout(() => {
                // window.location.href = 'checkout.html';
                alert('Função de checkout será implementada em breve!');
            }, 1500);
        }

        function updateFavoritesCount() {
            const count = document.getElementById('favoritosCount');
            if (favorites.length > 0) {
                count.textContent = favorites.length;
                count.style.display = 'inline';
            } else {
                count.style.display = 'none';
            }
        }

        function updateCartCount() {
            const count = document.getElementById('sacolaCount');
            const total = cart.reduce((sum, item) => sum + item.quantity, 0);
            if (total > 0) {
                count.textContent = total;
                count.style.display = 'inline';
            } else {
                count.style.display = 'none';
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 80px;
                right: 20px;
                background: #370400;
                color: white;
                padding: 15px 25px;
                border-radius: 4px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 10000;
                animation: slideIn 0.3s ease-out;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-out';
                setTimeout(() => notification.remove(), 300);
            }, 2000);
        }

        document.addEventListener('DOMContentLoaded', () => {
            loadCart();
        });
    </script>
</body>

</html>